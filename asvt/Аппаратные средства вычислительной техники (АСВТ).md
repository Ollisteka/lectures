# Аппаратные средства вычислительной техники (АСВТ)

> Кажется, нам очень помогут конспекты по АрхЭВМ: [гугл док](https://docs.google.com/document/d/1XzTffB8QRcV2zOeUswB6VNsJIcClAy_0paMBqt0wmpo/edit) и [Анины](https://drive.google.com/open?id=1mYZcITQctbF7K6Wa6IGF3uAjlzOiCqt2)



> 12.02.2019

У устройства есть физическая память. Это некая абстракция. Так как CPU, контроллеры и другие устройства могут видеть её по-разному. 

> вставить рисуночек! :smile_cat:

Шина

- адреса (разрядность - пока что максимум 48 бит, внешней к CPU)
- управления
- данных
- питания

Представления микроконтроллера.

40 бит - терабайт

Вычислитель только смотрит на шину адреса, данных и управления. Ставит команду (упр.) и адрес (адр.) на разные шины, отправляет. Устройство создаёт оптическую иллюзию, что процессор и вправду обратился к непрерывному сорока битному пространству, отправляя информацию по шине данных.

Каким способом может быть отображена ОП, регистры, ... устройств в ОЗУ?

1. Какой-то способ???

Компьютер загружается в <u>незащищённом</u> режиме. Модель памяти - flat. Сначала IP=0, потом смотрим на CS, IP+=CS. Размер адреса - 1МБ. Параграф - кратен 16 байт. Сегмент А0000, B0000… - 64кб страницы. Отобразили сначала ОЗУ, потом BIOS (в F0000). BIOS хранится на мат. плате.

2. Пространство ввода-вывода, порты ввода-вывода. Набор портов == пространство. У каждого порта есть номер. Свои порты знает только владелец. Отображаем регистры в порты по каким-то своим правилам.

Раньше использовали 6-разрядные порты. Ещё и выдали первые номера флоппи дисководам и com портам :neutral_face:

CMOS

RTC - для работы с ней используются 2 порта. В 70 порт пишем адрес того байта внутри CMOS, с которым хотим поработать*.*



>  *19.02.2019*

Все устройства сначала нужно запитать! Что устройство делает, после того, как получило питание?

1. Подготовиться — инициализироваться. Как инициализируется процессор? В IP=0, в CS=FFFF:0

   В итоге в IP: FFFF:0. (конец сегмента). В нём команда `JMP [начало BIOS'а]` (равносильно перезагрузке компьютера). 

2. Провериться — запустить POST (Power On Self Test).

   Записать и считать 55АА, потом АА55, должны получаться одинаковые значения.

3. Инициализировать внешние устройства. Идём по памяти, пока не найдём инициализатор.ЧТо

> У Intel CISC: 16 общего назначения, плавающие, MSR



Что означает инициализация памяти для контроллера? На ПЗУ вс

**Таблица векторов прерываний** — таблица с адресами обработчиков. Расположена с адреса 0000. Одна строка - 32 бита: сегментный адрес + смещение. Обработчики хранятся в BIOS'e

![iret](.\images\iret.png)



Механизмы опроса устройств:

- прерывания - плюс в том, что обнаружением событий занимается не программист
- polling

Виды прерываний:

- аппартные

  - внешние (по отношению к процессору)

    - маскируемые

      Приходят на ножку INT

    - немаскируемые

      Приходят на ножку NMI или SMI (System Managment Interrupt)

  - внутренние 

    - исключения (деление на 0)
    - trap 

- программные

  - функции BIOS
  - функции OS
  - breakpoints