### Численные методы

Преподаватель — Игорь Николаевич Кандоба

Допуск к зачёту и экзамену — 3 лабораторные в каждом семестре

Литература:

- Бахвалов Н.С. "Численные методы"

- Березин "Методы вычисления"

- Калиткин "Методы вычисления"

  

#### Последовательность моделей и структура погрешностей по Колмогорову

Есть *реальный объект*. Его можно исследовать, но сначала нужно описать ряд формальных свойств. Для этого по объекту строиться ряд моделей:

1. Математическая
2. Алгоритмическая
3. Вычислительная — код по алгоритму
4.  Число — результат выполненя

При переходе к от этапа к этапу возникают погрешности:

1. Неустранимая погрешность
2. **Погрешность метода** — будем заниматься ей
3. Вычислительная погрешность



**Пример**

- Функция синуса — математическая модель какого-то процесса колебаний.
- Чтобы посчитать синус, введём алгоритмическую модель — разложение синуса в ряд Тейлора. Так как сумма, которую мы можем посчитать, конечна, то остаток ряда, который мы отбрасываем является погрешностью метода.
- Вычислительная модель — код, который считает эту сумму. Из-за разных способов представления числа в компьютере возникает вычислительная погрешность.



#### Приближённые числовые характеристики и их точности

$x$  — точное число
$x^*$ — приближённое число

Характеристика точности — абсолютная и относительная погрешности.

**Абсолютной** погрешностью приближения $x^*$ называется величина $A_{x^*}$: $|x-x^*|\le A_{x^*}$ — точная нижняя грань

**Относительной** погрешностью приближения $x^*$ $(x^* \neq 0)$ называется величина $\Delta_{x^*}$: $|\frac{x-x^*}{x^*}|\le \Delta_{x^*}$ 

$x = x^* \pm A_{x^*}, x = x^*(1\pm\Delta_{x^*})$

$\Delta_{x^*} =\frac{A_{x^*}}{|x^*|}$ **[1]**

**Значащие цифры** — все цифры *позиционной* записи числа слева направо, начиная не с нулевой.

$0.00134 \rightarrow 134$

Цифра в позиционной записи $x^*$ называется **верной**, если абсолютная погрешность $A_{x^*}$ не превосходит половины единицы разряда, соответствующего этой цифры.

$x^*=23,01246$. $A_{x^*} = 0.004$

2: Половина разряда — 5, число верное

3: Половина разряда — 0.5, число верное

0: Разряд — 0.1, половина — 0.05, число верное

1: Разряд — 0.01, половина — 0.005

2: Разряд — 0.001, половина — 0.0005 < 0.004 — неверное



> **Вопрос**: связь между количеством верных значащих цифр числа и его относительной погрешностью



#### Погрешности арифметически операций

##### Сложение

$x_1,x_2,…,x_n$

$x_1^*,x_2^*,…,x_n^*$

$A_{x_1^*},A_{x_2^*},…,A_{x_n^*}$

Какая погрешность у суммы?

**Абсолютная**:

Воспользуемся свойством модуля

$A_{\sum{x_i^*}}$: $|\sum{x_i}-\sum{x_i^*}| \le A_{\sum{x_i^*}}$

$|\sum{x_i}-\sum{x_i^*}| = |\sum{x_i - x_i^*}| \le \sum{|x_i - x_i^*|} \le \sum{A_{x_i^*}}$

$A_{\sum{x_i^*}} = \sum{A_{x_i^*}}$ **[2]**

**Относительная**:

б.о.о: рассмотрим 2 слагаемых

Случай 1:

$x_i^* \ge 0$ или $x_i^* \le 0$ 

$\Delta_{x_1^*+x_2^*} =\frac{A_{x_1^*+x_2^*}}{|x_1^*+x_2^*|} = [2]= \frac{A_{x_1^*}+A_{x_2^*}}{|x_1^*|+|x_2^*|} = [1] = \frac{\Delta_{x_1^*}{|x_1^*|}+\Delta_{x_2^*}{|x_2^*|}}{|x_1^*|+|x_2^*|} \le  \frac{\overline{\Delta}{|x_1^*|}+\overline{\Delta}{|x_2^*|}}{|x_1^*|+|x_2^*|}= \overline{\Delta}$

Случай 2:

$x_1^* \ge 0, x_2^* \le 0$ 

$z_1^*=x_1^*, z_2^* = |x_2^*|$

$\Delta_{x_1^*+x_2^*} =\Delta_{z_1^*+z_2^*}=[1,2]=\frac{A_{z_1^*}+A_{z_2^*}}{|z_1^*|+|z_2^*|} = [1] = \frac{\Delta_{z_1^*}{|z_1^*|}+\Delta_{z_2^*}{|z_2^*|}}{|z_1^*|+|z_2^*|}$



**Пример**

$x_1 = \sqrt{11}$, $x_1^* = 3.32$, $A_{x_1^*} = 0.005$
$x_2 = \sqrt{10}$, $x_2^* = 3.16$, $A_{x_2^*} = 0.005$


$A_{x_1^*-x_2^*} =[2]=A_{x_1^*}+A_{x_2^*} =0.01 $


$x_1^*-x_2^* = 3.32 - 3.16 = 0.16$ — 6 уже неверное число

$x_1-x_2 = \sqrt{11} - \sqrt{10} = \frac{(\sqrt{11} - \sqrt{10})(\sqrt{11} + \sqrt{10})}{\sqrt{11} + \sqrt{10}} = \frac{1}{\sqrt{11} + \sqrt{10}} = \frac{1}{3.32+3.16} = \frac{1}{6.48} = 0.154$. Все значащие цифры верные, **почему**?

##### Функция

$y=f(x_1,x_2,…,x_n)$, $f\in C^1$

Подставим вместо чисел их приближения

$y^*=f(x_1^*,x_2^*,…,x_n^*)$. Чему равно абсолютная погрешность этого приближения?

$|y-y^*| = |f(x_1,x_2,…,x_n)-f(x_1^*,x_2^*,…,x_n^*)| = |F(1) - F(0)| = |F(\theta)(1-0)|, \theta \in [0,1] =$ $ = |\sum{\frac{\partial f(x^*+\theta h)}{\partial x_i}}h_i| \le \sum {|\frac{\partial f(x^*+\theta h)}{\partial x_i}h_i|} \le \sum {|\frac{\partial f(x^*+\theta h)}{\partial x_i}|*|h_i|} \le \sum {M_i A_{x_i^*}}$ **[3]** 

$M_i = \max{Q<\theta \le 1|\frac{\partial f(x^*+\theta h)}{\partial x_i}|}, i=1...n$

> $h=x-x^*$, $h=(h_1,h_2,...,h_n)^T \in \R^n$: $|h_i| \le A_{x_i^*} \forall i=1...n$
> $F(t) = f(x^*+th)$

Хак для практик: пусть что-то там достаточно малое. И что?

Пусть $A_{x_i^*} << 1 \forall i=1…n$

$|y-y^*| \le \sum {|\frac{\partial f(x^*+\theta h)}{\partial x_i}|*|A_{x_i^*}|}$

##### Умножение

$\prod x_i^* = f(x_1^*, x_2^*,...,x_n^*) = y^*$

A_{x_i^*}, i=1..n

x_i^* \neq 0

$A_{y^*} = \sum {|\frac{\partial f}{\partial x_i} (x^*)|*A_{x_i^*}} = |\frac{\partial |f(x^*)|}{|x^*|}|*|A_{x_i^*}| = |f(x^*)|\sum{\frac{A_{x_i^*}}{|x_i^*|}} = |f(x^*)| \sum{\Delta_{x_i^*}} $

$\Delta_{\prod x_i^*} = \frac{A_{y^*}}{|y^*|}=\sum{\Delta_{x_i^*}}$ **[5]**